<loading-overlay [loading]="loading">
  <div class="editing-form" *ngIf="submission">
    <div>
      <form [formGroup]="basicInfoForm" class="basic-form">
        <div class="w-50 d-inline-block">
          <mat-form-field color="accent">
            <input #titleInput matInput [placeholder]="'Title' | translate" formControlName="title" maxlength="50">
            <mat-hint align="end">{{ (titleInput.value || '').length }} / {{ 50 }}</mat-hint>
          </mat-form-field>

          <mat-form-field color="accent">
            <mat-select formControlName="rating" [placeholder]="'Rating' | translate" required>
              <mat-option value="General">{{ 'General' | translate }}</mat-option>
              <mat-option value="Mature">{{ 'Mature' | translate }}</mat-option>
              <mat-option value="Adult">{{ 'Adult' | translate }}</mat-option>
              <mat-option value="Extreme">{{ 'Extreme' | translate }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field color="accent">
            <input matInput formControlName="schedule" [placeholder]="'Schedule' | translate" [owlDateTime]="dtPicker" [owlDateTimeTrigger]="dtPicker">
            <mat-icon matSuffix style="font-size: 1.2em; vertical-align: top">schedule</mat-icon>
            <owl-date-time #dtPicker></owl-date-time>
          </mat-form-field>
        </div>

        <div class="pl-4 w-50 d-inline-block thumbnail-block" *ngIf="!hideForReload">
          <div class="thumbnail">
            <img (click)="thumbnailChange.click()" [src]="submission.id | thumbnail: 'THUMBNAIL' | async | toBase64: '100' | safe">
            <div>{{ 'Thumbnail' | translate }} &lt;= 2MB</div>
            <i class="fas fa-times warn-text" (click)="removeThumbnail()" *ngIf="submission.fileMap.THUMBNAIL"></i>
            <input #thumbnailChange type="file" class="d-none" accept="image/jpeg,image/png" single (change)="updateThumbnail($event)">
          </div>
        </div>
      </form>
    </div>

    <div>
      <form [formGroup]="formDataForm">
        <div class="w-100 d-flex">
          <button mat-button color="accent" (click)="openProfileSelect()" class="pl-0">
            <span *ngIf="formDataForm.value.loginProfile">{{ formDataForm.value.loginProfile | profileName }}</span>
            <span *ngIf="!formDataForm.value.loginProfile">{{ 'Select a Login Profile' | translate }}</span>
            <mat-icon>arrow_drop_down</mat-icon>
          </button>
          <mat-form-field color="accent" style="flex: 10">
            <mat-select formControlName="websites" [placeholder]="'Websites' | translate" required multiple>
              <mat-option [value]="registry.value.name" *ngFor="let registry of availableWebsites | keyvalue">{{ registry.value.websiteConfig.displayedName }}</mat-option>
            </mat-select>
          </mat-form-field>
          <button mat-button (click)="toggleLogin()" color="accent">{{ 'Login' | translate }}</button>
        </div>

        <!-- Defaults Section -->
        <div formGroupName="defaults">
          <h5>{{ 'Default Description' | translate }}
            <mat-icon class="help-icon" color="accent" [matTooltip]="'Default Description Tooltip' | translate">info</mat-icon>
          </h5>
          <description-input #defaultDescription formControlName="description" class="w-100" [canOverwrite]="false"></description-input>

          <div class="py-2"></div>

          <h5>{{ 'Default Tags' | translate }}
            <mat-icon class="help-icon" color="accent" [matTooltip]="'Default Tag Tooltip' | translate">info</mat-icon>
          </h5>
          <tag-input #defaultTags formControlName="tags" class="w-100" [canExtend]="false"></tag-input>
        </div>

        <!-- Selected Websites Section -->
      </form>
    </div>

    <div class="form-actions d-flex">
      <div style="flex: 10">
        <button mat-button color="warn" (click)="delete()">{{ 'Delete' | translate }}</button>
        <button mat-button color="warn" (click)="clear()">{{ 'Clear' | translate }}</button>
      </div>
      <div>
        <button mat-button color="primary">{{ 'Post' | translate }}</button>
      </div>
    </div>

    <div class="menu">
      <button mat-icon-button [matMenuTriggerFor]="formMenu">
        <mat-icon>more_horiz</mat-icon>
      </button>
      <mat-menu #formMenu="matMenu">
        <button mat-menu-item (click)="openCopySubmission()">{{ 'Copy Submission' | translate }}</button>
      </mat-menu>
    </div>
  </div>
</loading-overlay>
